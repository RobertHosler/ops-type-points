<div class="person-row" *ngIf="person">
  <div class="left-side">
    <div class="left-side-inner pl-3 py-3">
      <div class="person-wrapper">
        <h1>{{ person.name }}</h1>
        <div class="person-picture">
          <div *ngIf="person.pictureUrl" class="person-img">
            <img [src]="person.pictureUrl" />
          </div>
          <div *ngIf="!person.pictureUrl" class="person-img-missing">
            <img src="/assets/images/sp-logo-no-bg.png" />
          </div>
        </div>
        <div class="mb-2">
          <app-type-tags
            [tags]="person.tags"
            [allActive]="true"
          ></app-type-tags>
        </div>
      </div>
      <div class="type-selection">
        <div *ngIf="person.type">
          <div class="type-selector">
            <div class="btn-group" dropdown>
              <button
                class="btn btn-gray"
                *ngIf="person.type"
                (click)="activeTab = 'OPS'"
                [ngClass]="{ active: activeTab === 'OPS' }"
              >
                Objective Personality
              </button>
              <button
                dropdownToggle
                type="button"
                class="btn btn-gray dropdown-toggle"
                aria-controls="dropdown-basic"
                [ngClass]="{ active: activeTab === 'OPS' }"
              >
                <span class="caret"></span>
              </button>
              <ul
                id="dropdown-basic"
                *dropdownMenu
                class="dropdown-menu"
                role="menu"
                aria-labelledby="button-basic"
              >
                <li role="menuitem" *ngFor="let option of opsOptions">
                  <a
                    class="dropdown-item"
                    (click)="activeTab = 'OPS'; activeOps = option"
                    href="javascript:;"
                    >{{ option }}</a
                  >
                </li>
              </ul>
            </div>
          </div>
          <div class="type-row">
            <app-type-indicator
              class="type-indicator"
              [option]="1"
              [type]="person.type"
            ></app-type-indicator>
            <div>
              <strong>{{ person.type }}</strong>
            </div>
          </div>
        </div>
        <div *ngIf="person.eType">
          <div class="type-selector">
            <button
              class="btn btn-gray"
              *ngIf="person.eType"
              (click)="activeTab = 'Enneagram'"
              [ngClass]="{ active: activeTab === 'Enneagram' }"
            >
              Enneagram
            </button>
          </div>
          <div class="type-row">
            <app-type-indicator
              class="type-indicator"
              [option]="1"
              [eType]="person.fullEType"
            ></app-type-indicator>
            <div>
              <strong>{{ person.fullEType }}</strong>
            </div>
          </div>
        </div>
        <div *ngIf="person.wssType">
          <div class="type-selector">
            <button
              class="btn btn-gray"
              *ngIf="person.wssType"
              (click)="activeTab = 'WSS'"
              [ngClass]="{ active: activeTab === 'WSS' }"
            >
              Socionics
            </button>
          </div>
          <div class="type-row">
            <app-socionics-shape
              class="type-indicator"
              [type]="person.wssType"
            ></app-socionics-shape>
            <div>
              <div>
                <strong>{{ person.wssType }}</strong>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="right-side">
    <div class="right-side-inner px-3 mt-3 pb-5">
      <div *ngIf="activeTab === 'OPS'">
        <h2>
          {{ person.type }}
          <app-ops-type-animal
            size="32"
            [animalStack]="person.type.substring(9)"
          ></app-ops-type-animal>
        </h2>
        <div class="ops-visual-row">
          <div class="flex-center mx-3">
            <div class="ops-molecule" *ngIf="person.type.length === 16">
              <app-type-bubbles
                class="text-center"
                [showOptions]="false"
                [showType]="false"
                [opsTypes]="[personOpsType]"
              ></app-type-bubbles>
            </div>
          </div>
          <div
            class="person-dashboard"
            *ngIf="activeTab === 'OPS' && person.type.length === 16"
          >
            <app-type-dashboard [opsType]="personOpsType"></app-type-dashboard>
          </div>
        </div>
        <div></div>
        <div *ngIf="personOpsType">
          <div *ngIf="activeOps === 'Checklist'">
            <app-type-checklist [opsType]="personOpsType"></app-type-checklist>
          </div>
          <div *ngIf="activeOps === 'Description'" class="pt-3">
            <app-type-description
              [opsType]="personOpsType"
            ></app-type-description>
          </div>
          <div *ngIf="activeOps === 'Points'" class="pt-3">
            <app-type-points
              [opsType]="personOpsType"
              [simple]="true"
            ></app-type-points>
          </div>
        </div>
      </div>
      <div *ngIf="activeTab === 'Enneagram'">
        <div>
          <h2>{{ person.fullEType }}</h2>
        </div>
        <div>
          <app-enneagram-type [type]="person.coreEType"></app-enneagram-type>
        </div>
        <div *ngIf="person.instinct">
          <app-enneagram-instinct
            [instinct]="person.instinct"
          ></app-enneagram-instinct>
        </div>
        <div *ngIf="person.trifix">
          <app-enneagram-trifix [trifix]="person.trifix"></app-enneagram-trifix>
        </div>
      </div>
      <div *ngIf="activeTab === 'WSS'">
        <div>
          <h2>{{ person.wssType }}</h2>
        </div>
        <app-socionics-reference
          [type]="person.wssType"
        ></app-socionics-reference>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!person">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <div>No Person to Display</div>
</div>
