<div class="mt-3">
  <h2>Function Points Table</h2>
  <p>
    Points calculated for each function based on Modality, Grant Order,
    Activation Count, and Savior Status (see dashboard).
  </p>
  <table class="table mt-3">
    <thead>
      <th>Function</th>
      <th>Modality</th>
      <th>Grant</th>
      <th>Activation</th>
      <th>Savior</th>
      <th>Total</th>
    </thead>
    <tbody>
      <tr *ngFor="let function of functions; index as i">
        <td>{{ function.name }}</td>
        <td>{{ function.modalityPoints }}</td>
        <td>{{ function.grantPoints }}</td>
        <td>{{ function.activationPoints }}</td>
        <td>{{ function.saviorPoints }}</td>
        <td>{{ function.totalPoints }}</td>
      </tr>
    </tbody>
  </table>

  <div>
    <button
      type="button"
      class="btn btn-primary mb-3"
      (click)="configureOptions = !configureOptions"
    >{{!configureOptions ? 'Show': 'Hide' }} Points Configuration</button>
  </div>

  <div *ngIf="configureOptions">
    <div class="mt-3">
      <h3>Weights and Factors</h3>
      <p>
        Customize the weights and factors used to calculate the function points
        above. Points are calculated for each option by multipling the weight
        with the factor.
      </p>
    </div>

    <div class="row mb-3">
      <div class="col-lg-3 col-md-6">
        <table class="mb-3">
          <thead>
            <th colspan="3">Modality</th>
          </thead>
          <thead>
            <th>Label</th>
            <th>Factor</th>
            <th>Points</th>
          </thead>
          <tbody>
            <tr *ngFor="let mo of modalityOptions; index as i">
              <td>{{ mo.label }}</td>
              <td>
                <input
                  id="mo{{ i }}"
                  type="text"
                  class="form-control"
                  [(ngModel)]="mo.factor"
                />
              </td>
              <td>{{ mo.factor * modalityWeight }}</td>
            </tr>
            <tr>
              <td>Weight</td>
              <td colspan="2">
                <input
                  id="modalityWeight"
                  type="text"
                  class="form-control"
                  [(ngModel)]="modalityWeight"
                />
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="col-lg-3 col-md-6">
        <table class="mb-3">
          <thead>
            <th colspan="3">Activation</th>
          </thead>
          <thead>
            <th>Label</th>
            <th>Factor</th>
            <th>Points</th>
          </thead>
          <tbody>
            <tr *ngFor="let mo of activationOptions; index as i">
              <td>{{ mo.number }}</td>
              <td>
                <input
                  id="mo{{ i }}"
                  type="text"
                  class="form-control"
                  [(ngModel)]="mo.factor"
                />
              </td>
              <td>{{ mo.factor * activationWeight }}</td>
            </tr>
            <tr>
              <td>Weight</td>
              <td colspan="2">
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="activationWeight"
                />
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="col-lg-3 col-md-6">
        <table class="mb-3">
          <thead>
            <th colspan="3">Grant Order</th>
          </thead>
          <thead>
            <th>Label</th>
            <th>Factor</th>
            <th>Points</th>
          </thead>
          <tbody>
            <tr *ngFor="let opt of grantOptions; index as i">
              <td>{{ opt.number }}</td>
              <td>
                <input
                  id="mo{{ i }}"
                  type="text"
                  class="form-control"
                  [(ngModel)]="opt.factor"
                />
              </td>
              <td>{{ opt.factor * grantWeight }}</td>
            </tr>
            <tr>
              <td>Weight</td>
              <td colspan="2">
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="grantWeight"
                />
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="col-lg-3 col-md-6">
        <table class="mb-3">
          <thead>
            <th colspan="3">Savior</th>
          </thead>
          <thead>
            <th>Label</th>
            <th>Factor</th>
            <th>Points</th>
          </thead>
          <tbody>
            <tr *ngFor="let mo of saviorOptions; index as i">
              <td>{{ mo.option }}</td>
              <td>
                <input
                  id="mo{{ i }}"
                  type="text"
                  class="form-control"
                  [(ngModel)]="mo.factor"
                />
              </td>
              <td>{{ mo.factor * saviorWeight }}</td>
            </tr>
            <tr>
              <td>Weight</td>
              <td colspan="2">
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="saviorWeight"
                />
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div>
      <button type="button" (click)="assignPoints()" class="btn btn-primary">
        Reassign Points
      </button>
    </div>
  </div>
</div>
